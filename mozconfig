# Browser branding
ac_add_options --with-app-name=zen
ac_add_options --with-app-basename=Zen
ac_add_options --enable-official-branding
ac_add_options --with-branding=browser/branding/alpha

export MOZ_USER_DIR="Zen Browser"
export MOZ_APP_BASENAME=Zen
export MOZ_APP_PROFILE=zen
export MOZ_APP_DISPLAYNAME="Zen Browser"
export MOZ_APP_REMOTINGNAME="zen"
export MOZ_BRANDING_DIRECTORY=branding/unofficial
export MOZ_OFFICIAL_BRANDING_DIRECTORY=branding/unofficial
export MOZ_DISTRIBUTION_ID="com.zen.browser"
export MOZ_SOURCE_REPO=https://github.com/zen-browser/desktop
export MOZ_SOURCE_CHANGESET="${COMMIT_HEAD}"
export MOZ_INCLUDE_SOURCE_INFO=1

# Libraries
ac_add_options --target=x86_64-pc-linux
ac_add_options --prefix=/usr
ac_add_options --x-libraries=/usr/lib

# Localization
ac_add_options --with-l10n-base="$PWD/browser/locales"

# System libraries
ac_add_options --with-system-nspr
ac_add_options --with-system-nss

# Audio
ac_add_options --enable-alsa
ac_add_options --enable-pulseaudio
ac_add_options --enable-jack

# Disable Debug features
ac_add_options --disable-updater
ac_add_options --disable-debug
ac_add_options --disable-debug-symbols
ac_add_options --disable-debug-js-modules
ac_add_options --disable-crashreporter
ac_add_options --disable-geckodriver
ac_add_options --disable-tests
ac_add_options --disable-rust-tests
ac_add_options --disable-profiling
ac_add_options --disable-bootstrap

# Disable unwanted features
ac_add_options --disable-jprof
ac_add_options --disable-vtune
ac_add_options --disable-dmd
ac_add_options --disable-elf-hack
ac_add_options --disable-necko-wifi
ac_add_options --disable-default-browser-agent

# Optimize Build
ac_add_options --enable-release
ac_add_options --enable-optimize
ac_add_options --enable-jemalloc
ac_add_options --enable-hardening
ac_add_options --enable-linker=lld
ac_add_options --enable-wasm-avx
ac_add_options --enable-wasm-simd
ac_add_options --with-wasi-sysroot=/usr/share/wasi-sysroot
ac_add_options --enable-rust-simd

# Enable wanted features
ac_add_options --enable-raw
ac_add_options --enable-webrtc
ac_add_options --enable-jxl
ac_add_options --enable-av1
ac_add_options --enable-eme=widevine
ac_add_options --enable-unverified-updates
ac_add_options --enable-proxy-bypass-protection

# Addons
ac_add_options --allow-addon-sideload
ac_add_options --with-unsigned-addon-scopes=app,system
ac_add_options "MOZ_ALLOW_LEGACY_EXTENSIONS=1"

# Strip
export STRIP_FLAGS="--strip-debug --strip-unneeded"
ac_add_options --enable-install-strip
ac_add_options --enable-strip

# Make Configs
ac_add_options MOZ_LTO=1
ac_add_options RUSTC_OPT_LEVEL="3"
mk_add_options MOZILLA_OFFICIAL=1
mk_add_options AUTOCLOBBER=1
mk_add_options MOZ_OPTIMIZE=3
mk_add_options MOZ_MAKE_FLAGS="-j$(nproc --all)"
mk_add_options MOZ_PARALLEL_BUILD="$(nproc --all)"
mk_add_options MOZ_OBJDIR=${BUILD_OBJ_PATH}
mk_add_options MOZ_REQUIRE_SIGNING=

# sccache
mk_add_options RUSTC_WRAPPER=$(which sccache)
mk_add_options CCACHE_CPP2=yes
ac_add_options --with-ccache=$(which sccache)
mk_add_options SCCACHE_GHA_ENABLED=on

# Disable Telemetry
mk_add_options MOZ_DATA_REPORTING=0
mk_add_options MOZ_SERVICES_HEALTHREPORT=0
mk_add_options MOZ_TELEMETRY_REPORTING=0
